<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ASSITIR AO VIVO</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans">

  <div class="max-w-4xl mx-auto py-10 px-4">
    <h1 class="text-3xl font-bold text-center text-purple-700 mb-6">Assistir Canais Ao Vivo</h1>

    <div class="flex items-center gap-2">
      <input id="search" type="text" placeholder="Ex: Flamengo, Real Madrid, Globo..." class="w-full p-3 rounded border border-gray-300 shadow focus:outline-none focus:ring-2 focus:ring-purple-600">
      <button onclick="buscar()" class="bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700">Buscar</button>
    </div>

    <div id="resultados" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mt-8">
      <!-- Resultados aparecerÃ£o aqui -->
    </div>

    <div id="player" class="mt-8 hidden">
      <h2 class="text-xl font-semibold mb-2 text-center">Assistir Agora</h2>
      <iframe id="iframe" src="" width="100%" height="400" frameborder="0" allowfullscreen class="rounded shadow-lg"></iframe>
    </div>
  </div>

  <script>
    async function buscar() {
      const query = document.getElementById('search').value.trim();
      if (!query) return alert("Digite algo para buscar");

      const resultados = document.getElementById('resultados');
      const player = document.getElementById('player');
      resultados.innerHTML = '<p class="text-gray-500">Buscando...</p>';
      player.classList.add('hidden');

      try {
        const res = await fetch(\`https://world-ecletix.onrender.com/api/assistir?oq=\${encodeURIComponent(query)}\`);
        const data = await res.json();

        if (data.resultados.length === 0) {
          resultados.innerHTML = '<p class="text-red-600">Nenhum resultado encontrado.</p>';
          return;
        }

        resultados.innerHTML = '';
        data.resultados.forEach(item => {
          const card = document.createElement('div');
          card.className = 'bg-white p-4 rounded shadow hover:shadow-md transition cursor-pointer';
          card.innerHTML = \`
            <img src="\${item.imagem}" alt="" class="w-full h-40 object-cover rounded mb-2">
            <h3 class="text-lg font-semibold text-purple-700 mb-1">\${item.titulo}</h3>
            <button class="text-sm text-purple-600 hover:underline">Assistir</button>
          \`;
          card.addEventListener('click', () => {
            document.getElementById('iframe').src = item.link;
            player.classList.remove('hidden');
            window.scrollTo({ top: player.offsetTop - 20, behavior: 'smooth' });
          });
          resultados.appendChild(card);
        });

      } catch (err) {
        console.error(err);
        resultados.innerHTML = '<p class="text-red-600">Erro ao buscar resultados.</p>';
      }
    }
  </script>
</body>
</html>
